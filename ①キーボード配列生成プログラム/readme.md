# キーボード配列最適化・可視化ツール (Keyboard Layout Optimizer & Visualizer)

ユーザーの入力テキストデータを元に「指の移動距離」や「疲労」を最小化するキーボード配列を自動生成し、その配列の打鍵頻度をヒートマップで可視化・比較するためのHTMLツールセットです。

## 📂 含まれるファイル

1.  **`keyboard_optimizer_json.html`**
    * **機能**: 焼きなまし法（Simulated Annealing）を用いて、指定した文章に最適なキー配列を計算・生成します。結果をJSON形式で出力します。
2.  **`keyboard_heatmap.html`**
    * **機能**: 文章を入力した際のキー使用頻度をヒートマップ化し、一般的なQWERTY配列と独自配列（JSON読み込み）を視覚的に比較します。

## 🚀 使い方

インストールは不要です。各HTMLファイルをモダンなWebブラウザ（Chrome, Edge, Firefox, Safariなど）で開くだけで動作します。

### 手順1: 最適な配列を作る (`keyboard_optimizer_json.html`)

1.  `keyboard_optimizer_json.html` をブラウザで開きます。
2.  **サンプルテキスト入力**:
    * 最適化の基準としたいテキスト（ブログ、コード、チャットログなど）を入力欄に貼り付けます。
    * *推奨*: 日本語入力（ローマ字）を想定している場合、ローマ字に変換済みのテキストか、英語の文章を入力してください。
3.  **パラメータ設定** (任意):
    * `距離ペナルティ(d)`: 指の移動距離を重視する場合に上げます。
    * `同一指連打(h)`: 同じ指の連続使用を防ぎたい場合に上げます。
    * `同一手連続(f)`: 左右交互打鍵を増やしたい場合に上げます。
4.  **計算実行**:
    * `前計算` ボタンをクリックします。
    * `焼きなまし開始` ボタンをクリックします。（数秒〜数十秒待ちます）
5.  **結果の保存**:
    * 最適化が完了したら `結果をJSON出力` ボタンを押します。
    * 表示されたJSONコードをコピーし、メモ帳などに貼り付け、**`layout.json`** などの名前で保存してください。

### 手順2: 配列を評価する (`keyboard_heatmap.html`)

1.  `keyboard_heatmap.html` をブラウザで開きます。
2.  **テストテキスト入力**:
    * 打鍵テストを行いたい文章を入力します。
3.  **独自配列の読み込み**:
    * `ファイルを選択` ボタンを押し、手順1で保存した `layout.json` をアップロードします。
4.  **解析**:
    * `更新` ボタンを押します。
    * **QWERTY**（既存）と **独自配列**（最適化後）のヒートマップが表示されます。
    * 独自配列側で、ホームポジション（中段）や人差し指・中指に赤い色（高頻度）が集まっていれば最適化成功です。

---

## ⚙️ 技術仕様

### スコアリング（コスト関数）
以下の要素の加重和を最小化するように動作します。
$$Cost = \sum (Distance \times d) + (SameFinger \times h) + (SameHand \times f)$$

* **d (Distance)**: ホームポジションからの物理的距離（往復）。
* **h (SameFinger)**: 直前の打鍵と同じ指を使う場合のペナルティ。
* **f (SameHand)**: 直前の打鍵と同じ手を使う場合のペナルティ。

### アルゴリズム
**焼きなまし法 (Simulated Annealing)** を採用しています。
初期段階ではスコアが悪化する変更も確率的に受け入れることで局所解（Local Optima）を回避し、徐々に温度（許容度）を下げることで大域的な最適解を探索します。
